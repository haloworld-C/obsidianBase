### 内存使用
分为静态存储区， 栈区， 与heap区。
原始C中使用`maclloc`和`free`函数调用， 在heap区上调用。
C++中使用new与delete进行内存的分配与释放（主要是在对象上涉及构造与析构）。
C++ 11以后提供了`shared_ptr`, `unique_ptr`与`weak_ptr`三种智能指针. 智能指针表现的像是指针的对象， 旨在避免内存相关的错误。
`shared_ptr`内部提供计数引用的机制， 保证最后一个指针离开作用域后， 调用析构函数。
`unique_ptr`不能进行赋值操作。
`weak_ptr`设计是为了解决循环引用的问题， 比如双向链表的实现。
#### 如何避免内存碎片
1. 尽量使用连续空间的数据类型(数组, vector)
2. 使用`allocator`(自己写 ，or第三方TcMalloc)
### 虚函数
实现机制是虚函数表(`vtable`)， 根据对象类型的不同`vptr`指向不同的虚函数，会使对象的体积扩大50%~100%。虚函数表是在构造函数阶段完成初始化的。
- 为什么构造函数不能是虚函数
因为构造函数阶段， `vtable`还未初始化完成， 故也无法决定该调用哪个构造函数。
从使用的角度来说也没必要， 因为构造函数在编译阶段已经知道类型， 无需动态绑定。