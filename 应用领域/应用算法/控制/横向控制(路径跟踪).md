### pure pursuit controller
- 关键在于选择一个合适的look_ahead_point
![pure pursuit](pure_pursuit.jpg)
1. 通过速度进行调节
$$
L_t=k*v_t
$$
2.  形式二
$$
L_t=v_t*l_t
$$
$l_t$含义需要进一步调研[ref](Ohta H, Akai N, Takeuchi E, Kato S, Edahiro M. Adaptive Pure Pursuit Model for Autonomous Vehicle Path Tracking. Interna-tional Journal of Science. 2017;4(3):70–73.)
### 讨论
1. 实际的实现中还要考虑，根据曲率去限制线速度
2. 周围距离动态障碍物过近时， 降低线速度以保证安全
3. 在预瞄点的选择上，可以考虑路径的曲率
4. 如果局部路径切换比较频繁， 那么其跟踪效果也不是很理想
### PID tracking Algorithm
#### 误差模型
$$
\left[ \begin{array}{c}
\dot{e}_1 \\
\dot{e}_2  \\
\dot{e}_3
  \end{array} \right]=
\left[ \begin{array}{cc}
1 & e_2\\
0 & e_1 \\
0  & 1 
  \end{array} \right] *
\left[ \begin{array}{c}
v_c \\
w_c  \\
\end{array} \right] 
+
\left[ \begin{array}{cc}
-cos(e_3) & 0\\
sin(e_3) & 0 \\
0  & -1 
  \end{array} \right] *
\left[ \begin{array}{c}
v_r \\
w_r  \\
\end{array} \right] 
$$
> 其推导详见[[两轮差速驱动运动模型]], $e_1, e_2, e_3$分别为纵向、横向、航向误差。$v_c, w_c$ 为车辆速度， $v_r, w_r$为路径上的规划速度。
> 公式待确认

一般跟踪过程中， 我们取机器在路径上的投影点作为跟踪目标故$e_1 \rightarrow 0$， 而且由于有局部路径规划有: $e_3 \rightarrow$ 0, 故模型可以简化如下: 

$$
\left[ \begin{array}{c}
\dot{e}_2  \\
\dot{e}_3
  \end{array} \right]=
\left[ \begin{array}{cc}
0 & 0 \\
0  & 1 
  \end{array} \right] *
\left[ \begin{array}{c}
v_c \\
w_c  \\
\end{array} \right] 
+
\left[ \begin{array}{cc}
e_3 & 0 \\
0  & -1 
  \end{array} \right] *
\left[ \begin{array}{c}
v_r \\
w_r  \\
\end{array} \right] 
$$
> 其中$w_r, v_r$是已知量， 我们的控制目标是$e_2 \rightarrow 0$, $e_3 \rightarrow 0$
#### 控制律设计
虚拟控制量$u=w_c-w_r=-k_1e_3 -k_2v_re_2$故上式可写为:
$$
\left[ \begin{array}{c}
\dot{e}_2  \\
\dot{e}_3
  \end{array} \right]=
\left[ \begin{array}{c}
v_re_3 \\
-k_1e_3-k_2v_re_2  \\
\end{array} \right] =
\left[ \begin{array}{cc}
0 & v_r \\
-k_2v_r  & -k_1
  \end{array} \right] 
\left[ \begin{array}{c}
e_2  \\
e_3
  \end{array} \right]
$$
上式对应状态转移矩阵A的特征多项式为:
$$
\lambda^2+k_1\lambda+k_2v_r^2=0
$$
当我们选取$k_1>0, k_2>0$的情况下， 上面特征方程的根都在复平面的左边(实部小于0), 故该系统稳定。 该控制律对应闭环系统二阶系统特征方程为:
$$
\lambda^2+2\xi{w_n}\lambda+w_n^2=0
$$
> 其中$\xi$为阻尼系数， $w_n$为带宽

故$k_1$, $k_2$可根据二阶系统的特征参数选取:
$$\left\{\begin{matrix}
 k_1 = 2\xi{w_n} \\
 k_2 = \frac{w_n^2 }{v_r^2}
 
\end{matrix}\right.$$
故最终的横向跟踪控制律为$$
w_c=w_r-k_1e_3-k_2v_re_2
$$
> 该控制律虽然形式上可以归类于PID的控制但是， 本质上是一种全状态反馈控制律， 可以能够让横向误差与航向误差同时收敛。
> 本质上解耦的路径跟踪算法为二阶系统， 使用单通道PID在理论上无法同时跟踪航向与横向目标
### 稳定性分析
补充
### 仿真demo
### LQR
#### concept
LQR可以理解为一种没有滚动优化的MPC
LQR最后的推导结果仅与初始误差有关，可以看做是一种比例反馈控制器
#### 算法推导
详见[[LQR控制器]]
### MPC
参见[[MPC控制算法推导]]